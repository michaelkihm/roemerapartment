name: Deploy to Heroku  
  
on:  
  push:  
    branches:  
      - main  # Change this to your default branch if it's not 'main'  
  
jobs:  
  build:  
    runs-on: ubuntu-latest  
  
    steps:  
      - name: Checkout code  
        uses: actions/checkout@v2  
  
      - name: Set up Node.js  
        uses: actions/setup-node@v2  
        with:  
          node-version: '22.2.0'  # Specify the Node.js version you are using  
  
      - name: Install dependencies  
        run: npm install
      
      - name: Generate Prisma Client  
        run: npx prisma generate

      - name: Run Prisma migrations  
        env:  
          DATABASE_URL: ${{ secrets.DATABASE_URL }}  
        run: npx prisma migrate deploy  
  
      - name: Build the project  
        env:  
          DATABASE_URL: ${{ secrets.DATABASE_URL }}  
        run: npm run build  
  
      - name: Deploy to Heroku  
        env:  
          HEROKU_API_KEY: ${{ secrets.HEROKU_API_KEY }}  
          HEROKU_APP_NAME: roemer-app 
        run: git push heroku main 